{% extends 'admin/admin_base.html.twig' %}
{% block title %}{{ action == 'add' ? 'Ajouter un produit' : 'Modifier le produit' }}{% endblock %}

{% block body %}
<div class="admin-header">
  <h1><i class="fas fa-{{ action == 'add' ? 'plus' : 'edit' }}"></i> {{ action == 'add' ? 'Nouveau produit' : 'Modifier le produit' }}</h1>
  <p class="subtitle">Champs simples : nom, prix, description, stock, image</p>
</div>

<div class="admin-actions" style="margin-bottom:20px;">
  <a href="{{ path('admin_products_index') }}" class="btn btn-outline"><i class="fas fa-arrow-left"></i> Retour</a>
</div>

<div class="admin-form">
  <form method="post">
    <div class="form-row">
      <div class="form-group">
        <label for="name"><i class="fas fa-tag"></i> Nom *</label>
        <input id="name" name="name" class="form-control" required value="{{ product ? product.name : '' }}" placeholder="Ex: Côte de bœuf">
      </div>
      <div class="form-group">
        <label for="price"><i class="fas fa-euro-sign"></i> Prix (€) *</label>
        <input id="price" name="price" type="number" step="0.01" min="0" class="form-control" required value="{{ product ? product.price : '' }}">
      </div>
    </div>

    <div class="form-group">
      <label for="description"><i class="fas fa-align-left"></i> Description</label>
      <textarea id="description" name="description" rows="4" class="form-control">{{ product ? product.description : '' }}</textarea>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="stock"><i class="fas fa-boxes"></i> Stock *</label>
        <input id="stock" name="stock" type="number" min="0" class="form-control" required value="{{ product ? product.stock : 0 }}">
      </div>
      <div class="form-group">
        <label for="category_id"><i class="fas fa-tags"></i> Catégorie *</label>
        <select id="category_id" name="category_id" class="form-control" required>
          <option value="">Choisir une catégorie</option>
          {% for category in categories %}
            <option value="{{ category.id }}" 
              {% if product and product.category and product.category.id == category.id %}selected{% endif %}>
              {{ category.name }}
            </option>
          {% endfor %}
        </select>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="unit"><i class="fas fa-ruler"></i> Unité</label>
        <select id="unit" name="unit" class="form-control">
          <option value="kg" {% if product and product.unit == 'kg' %}selected{% elseif not product %}selected{% endif %}>kg</option>
          <option value="pièce" {% if product and product.unit == 'pièce' %}selected{% endif %}>pièce</option>
          <option value="g" {% if product and product.unit == 'g' %}selected{% endif %}>g</option>
        </select>
      </div>
      <div class="form-group">
        <label for="image"><i class="fas fa-image"></i> Image (nom de fichier)</label>
        <input id="image" name="image" class="form-control" value="{{ product ? product.image : '' }}" placeholder="ex: cote-boeuf.jpg">
        {% if product and product.image %}
          <div style="margin-top:10px;">
            <img src="{{ asset('images/products/' ~ product.image) }}" alt="{{ product.name }}" style="max-width:150px;border-radius:8px;">
          </div>
        {% endif %}
      </div>
    </div>

    <div class="admin-actions">
      <button class="btn btn-success"><i class="fas fa-save"></i> {{ action == 'add' ? 'Ajouter' : 'Enregistrer' }}</button>
      <a href="{{ path('admin_products_index') }}" class="btn btn-secondary" style="background:#6c757d;"><i class="fas fa-times"></i> Annuler</a>
    </div>
  </form>
</div>
{% endblock %}
